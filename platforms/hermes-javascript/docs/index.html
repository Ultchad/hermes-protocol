<!doctype html>
<html class="default no-js">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>hermes-javascript</title>
	<meta name="description" content="">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="assets/css/main.css">
</head>
<body>
<header>
	<div class="tsd-page-toolbar">
		<div class="container">
			<div class="table-wrap">
				<div class="table-cell" id="tsd-search" data-index="assets/js/search.js" data-base=".">
					<div class="field">
						<label for="tsd-search-field" class="tsd-widget search no-caption">Search</label>
						<input id="tsd-search-field" type="text" />
					</div>
					<ul class="results">
						<li class="state loading">Preparing search index...</li>
						<li class="state failure">The search index is not available</li>
					</ul>
					<a href="index.html" class="title">hermes-javascript</a>
				</div>
				<div class="table-cell" id="tsd-widgets">
					<div id="tsd-filter">
						<a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a>
						<div class="tsd-filter-group">
							<div class="tsd-select" id="tsd-filter-visibility">
								<span class="tsd-select-label">All</span>
								<ul class="tsd-select-list">
									<li data-value="public">Public</li>
									<li data-value="protected">Public/Protected</li>
									<li data-value="private" class="selected">All</li>
								</ul>
							</div>
							<input type="checkbox" id="tsd-filter-inherited" checked />
							<label class="tsd-widget" for="tsd-filter-inherited">Inherited</label>
						</div>
					</div>
					<a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a>
				</div>
			</div>
		</div>
	</div>
	<div class="tsd-page-title">
		<div class="container">
			<ul class="tsd-breadcrumb">
				<li>
					<a href="globals.html">Globals</a>
				</li>
			</ul>
			<h1> hermes-javascript</h1>
		</div>
	</div>
</header>
<div class="container container-main">
	<div class="row">
		<div class="col-8 col-content">
			<div class="tsd-panel tsd-typography">
				<h1 id="hermes-javascript">hermes-javascript</h1>
				<h4 id="a-javascript-wrapper-around-the-hermes-protocol">A javascript wrapper around the hermes protocol</h4>
				<p><a href="https://travis-ci.org/snipsco/hermes-protocol"><img src="https://travis-ci.org/snipsco/hermes-protocol.svg?branch=master" alt="Build Status"></a>
				<a href="https://www.npmjs.com/package/hermes-javascript"><img src="https://badge.fury.io/js/hermes-javascript.svg" alt="npm version"></a></p>
				<h2 id="context">Context</h2>
				<p>The <code>hermes-javascript</code> library provides bindings for the <a href="https://docs.snips.ai/ressources/hermes-protocol">Hermes protocol</a> that <a href="https://snips.ai">Snips</a> components use to communicate together. <code>hermes-javascript</code> allows you to interface seamlessly with the <a href="https://docs.snips.ai/">Snips platform</a> and create Voice applications with ease!</p>
				<p><code>hermes-javascript</code> abstracts away the connection to the <a href="http://mqtt.org/">MQTT</a> bus and the parsing of incoming and outcoming messages from and to the components of the platform and provides a high-level API as well.</p>
				<h2 id="setup">Setup</h2>
				<pre><code class="language-sh">npm install hermes-javascript</code></pre>
				<p><code>Hermes-javascript</code> uses a dynamic library generated by the hermes rust code under the hood.
				The installation process will automagically download the file if your os and architecture is supported.</p>
				<h4 id="-unsupported-platforms-architectures">⚠️ Unsupported platforms / architectures</h4>
				<p>If the setup could not infer the library file version, it will attempt to build it from the sources.
				Please note that <a href="https://www.rust-lang.org/tools/install"><code>rust</code></a> and <a href="https://git-scm.com/book/en/v2/Getting-Started-Installing-Git"><code>git</code></a> are required in order to build the library!</p>
				<p>If you want to force this behaviour, you can also define the <code>HERMES_BUILD_FROM_SOURCES</code> environment variable before running <code>npm install</code>.</p>
				<pre><code class="language-sh">env HERMES_BUILD_FROM_SOURCES=<span class="hljs-literal">true</span> npm install hermes-javascript</code></pre>
				<h2 id="usage">Usage</h2>
				<h3 id="minimal-use-case">Minimal use case</h3>
				<pre><code class="language-js"><span class="hljs-keyword">const</span> { withHermes } = <span class="hljs-built_in">require</span>(<span class="hljs-string">'hermes-javascript'</span>)

<span class="hljs-comment">/*
    A small js context manager that sets up an infinite loop to prevent
    the process from exiting, and exposes an instance of the Hermes class.
*/</span>
withHermes(<span class="hljs-function"><span class="hljs-params">hermes</span> =&gt;</span> {
    <span class="hljs-comment">// Instantiate a dialog object</span>
    <span class="hljs-keyword">const</span> dialog = hermes.dialog()

    <span class="hljs-comment">// Subscribes to intent 'myIntent'</span>
    dialog.flow(<span class="hljs-string">'myIntent'</span>, (msg, flow) =&gt; {
        <span class="hljs-comment">// Log intent message</span>
        <span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">JSON</span>.stringify(msg))
        <span class="hljs-comment">// End the session</span>
        flow.end()
        <span class="hljs-comment">// Use text to speech</span>
        <span class="hljs-keyword">return</span> <span class="hljs-string">`Received message for intent <span class="hljs-subst">${myIntent}</span>`</span>
    })
})</code></pre>
				<h3 id="expanded-use-case">Expanded use case</h3>
				<pre><code class="language-js"><span class="hljs-keyword">const</span> { withHermes } = <span class="hljs-built_in">require</span>(<span class="hljs-string">'hermes-javascript'</span>)

<span class="hljs-comment">/*
    The 'withHermes' function exposes a done() function
    that can be called to clean up the context loop and exit.
*/</span>
withHermes(<span class="hljs-function">(<span class="hljs-params">hermes, done</span>) =&gt;</span> {
    <span class="hljs-comment">// NB: Dialog is only one of the available API Subsets.</span>
    <span class="hljs-keyword">const</span> dialog = hermes.dialog()

    <span class="hljs-comment">/*
        Every API Subset can publish and receive data based on a list of events.

        For the purpose of this example, we will only use the Dialog subset, and the
        events related to a dialog session.

        Note that more events are available for each subset.
    */</span>

    <span class="hljs-comment">// You can subscribe to an event triggered when the intent 'intentName' is detected like this:</span>
    dialog.on(<span class="hljs-string">'intent/intentName'</span>, message =&gt; {

        <span class="hljs-comment">// The 'message' argument contain all the data you need to perform an action based on what the user said.</span>

        <span class="hljs-comment">// For instance, you can grab a slot and its value like this.</span>
        <span class="hljs-keyword">const</span> mySlot = msg.slots.find(<span class="hljs-function"><span class="hljs-params">slot</span> =&gt;</span> slot.slotName === <span class="hljs-string">'slotName'</span>)
        <span class="hljs-keyword">const</span> slotValue = mySlot.value.value
        <span class="hljs-comment">// And here is how to grab the intent name.</span>
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Received intent'</span>, message.intent.intentName)

        <span class="hljs-comment">// Then, you can either:</span>
        <span class="hljs-keyword">if</span>(continueSession) {
            <span class="hljs-comment">// 1 - Continue the dialog session if you expect another intent to be detected.</span>
            dialog.publish(<span class="hljs-string">'continue_session'</span>, {
                <span class="hljs-attr">sessionId</span>: message.sessionId,
                <span class="hljs-attr">text</span>: <span class="hljs-string">'Session continued'</span>,
                <span class="hljs-comment">// In this case, if you already set up a subscription for 'intent/nextIntent' then it will be triggered if the user speaks that intent.</span>
                intentFilter: [<span class="hljs-string">'nextIntent'</span>]
            })
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">// 2 - Or end the dialog session.</span>
            dialog.publish(<span class="hljs-string">'end_session'</span>, {
                <span class="hljs-attr">sessionId</span>: message.sessionId,
                <span class="hljs-attr">text</span>: <span class="hljs-string">'Session ended'</span>
            })
        }
        <span class="hljs-comment">// !! But not both !!</span>
    })

    <span class="hljs-comment">// You can also unsubscribe to a registered event.</span>
    <span class="hljs-keyword">const</span> handler = <span class="hljs-function"><span class="hljs-params">message</span> =&gt;</span> {
        <span class="hljs-comment">// In this case, unsubscribe the first time this message is received.</span>
        dialog.off(<span class="hljs-string">'intent/someIntent'</span>, handler)
        <span class="hljs-comment">// ...</span>
    }
    dialog.on(<span class="hljs-string">'intent/someIntent'</span>, handler)

    <span class="hljs-comment">// Or process a subscription only once:</span>
    dialog.once(<span class="hljs-string">'intent/someIntent'</span>, message =&gt; {
        <span class="hljs-comment">// ...</span>
    })

    <span class="hljs-comment">/*
        Now this is all for the basics, but for managing a dialog session
        using .on / .off / .once / .publish is actually not the best way!

        The Dialog API also exposes a small wrapper that make these operations much easier,
        and it is strongly recommended to use this wrapper instead!

        See below for an example on how to build a dialog flow tree using this API.
    */</span>

    <span class="hljs-comment">/*
        The goal is to register the following dialog paths:
        A
        ├── B
        │   └─ D
        └── C
        In plain words, intent 'A' starts the flow, then restrain the next intents to 'B' or 'C'.
        If 'B' is the next intent detected, then next intent must be 'D' (and end the flow after 'D').
        If it was 'C', end the flow.
    */</span>
    dialog.flow(<span class="hljs-string">'A'</span>, (msg, flow) =&gt; {

        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Intent A received. Session started.'</span>)

        <span class="hljs-comment">/*
            At each step of the dialog flow, you have the choice of
            registering the next intents, or end the flow.

            We then subscribe to both intent B or C so that the dialog
            flow will continue with either one or the other next.
        */</span>

        <span class="hljs-comment">// Mark intent 'B' as one of the next dialog intents. (A -&gt; B)</span>
        flow.continue(<span class="hljs-string">'B'</span>, (msg, flow) =&gt; {
            <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Intent B received. Session continued.'</span>)

            <span class="hljs-comment">// Mark intent 'D'. (A -&gt; B -&gt; D)</span>
            flow.continue(<span class="hljs-string">'D'</span>, (msg, flow) =&gt; {
                <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Intent D received. Session is ended.'</span>)
                flow.end()
                <span class="hljs-keyword">return</span> <span class="hljs-string">'Finished the session with intent D.'</span>
            })

            <span class="hljs-comment">// Make the TTS say that.</span>
            <span class="hljs-keyword">return</span> <span class="hljs-string">'Continue with D.'</span>
        })

        <span class="hljs-comment">// Mark intent 'C' as one of the next dialog intents. (A -&gt; C)</span>
        flow.continue(<span class="hljs-string">'C'</span>, (msg, flow) =&gt; {
            <span class="hljs-keyword">const</span> slotValue = msg.slots[<span class="hljs-number">0</span>].value.value
            <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Intent C received. Session is ended.'</span>)
            flow.end()
            <span class="hljs-keyword">return</span> <span class="hljs-string">'Finished the session with intent C having value '</span> + slotValue + <span class="hljs-string">' .'</span>
        })

        <span class="hljs-comment">// The continue / end message options (basically text to speech)</span>
        <span class="hljs-comment">// If the return value is a string, then it is equivalent to { text: '...' }</span>
        <span class="hljs-keyword">return</span> <span class="hljs-string">'Continue with B or C.'</span>
    })

})</code></pre>
				<h2 id="api">API</h2>
				<p><strong>Sections:</strong></p>
				<ul>
					<li><a href="#context-loop">Context loop</a></li>
					<li><a href="#hermes-class">Hermes class</a></li>
					<li><a href="#common-apisubset-methods">Common ApiSubset methods</a></li>
					<li><a href="#dialog-api-subset">Dialog Api Subset</a></li>
					<li><a href="#dialogflow">DialogFlow</a></li>
					<li><a href="#injection-api-subset">Injection Api Subset</a></li>
					<li><a href="#feedback-api-subset">Feedback Api Subset</a></li>
					<li><a href="#tts-api-subset">Tts Api Subset</a></li>
				</ul>
				<hr>
				<h3 id="context-loop">Context loop</h3>
				<h6 id="back-"><a href="#api">Back ⬆️</a></h6>
				<p>An hermes client should implement a context loop that will prevent the program from exiting.</p>
				<h4 id="using-withhermes">Using withHermes</h4>
				<pre><code class="language-js"><span class="hljs-keyword">const</span> { withHermes } = <span class="hljs-built_in">require</span>(<span class="hljs-string">'hermes-javascript'</span>)

<span class="hljs-comment">// Check the Hermes class documentation (next section) for available options.</span>
<span class="hljs-keyword">const</span> hermesOptions = { <span class="hljs-comment">/* ... */</span> }

<span class="hljs-comment">/*
The withHermes function automatically sets up the context loop.

Arguments:
   - hermes is a freshly created instance of the Hermes class
   - call done() to exit the loop and destroy() the hermes instance
*/</span>
withHermes(<span class="hljs-function">(<span class="hljs-params">hermes, done</span>) =&gt;</span> {
    <span class="hljs-comment">/* ... */</span>
}, hermesOptions)</code></pre>
				<h4 id="instantiate-hermes-and-use-the-keepalive-tool">Instantiate Hermes and use the keepAlive tool</h4>
				<p>In case you want to create and manage the lifetime of the Hermes instance yourself, you can
				use <code>keepAlive</code> and <code>killKeepAlive</code> to prevent the <code>node.js</code> process from exiting.</p>
				<pre><code class="language-js"><span class="hljs-keyword">const</span> { Hermes, <span class="hljs-attr">tools</span>: { keepAlive, killKeepAlive }} = <span class="hljs-built_in">require</span>(<span class="hljs-string">'hermes-javascript'</span>)

<span class="hljs-keyword">const</span> hermes = <span class="hljs-keyword">new</span> Hermes(<span class="hljs-comment">/* options, see below (next section) */</span>)

<span class="hljs-comment">// Sleeps for 60000 miliseconds between each loop cycle to prevent heavy CPU usage</span>
<span class="hljs-keyword">const</span> keepAliveRef = keepAlive(<span class="hljs-number">60000</span>)

<span class="hljs-comment">// Call done to free the Hermes instance resources and stop the loop</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">done</span> (<span class="hljs-params"></span>) </span>{
    hermes.destroy()
    killKeepAlive(keepAliveRef)
}

<span class="hljs-comment">/* ... */</span></code></pre>
				<h3 id="hermes-class">Hermes class</h3>
				<p>The Hermes class provides foreign function interface bindings to the Hermes protocol library.</p>
				<p><strong>⚠️ Important: Except for very specific use cases, you should have only a single instance of the Hermes class in your program. It can either be provided by the <code>withHermes</code> function OR created by calling <code>new Hermes()</code>.</strong></p>
				<p><strong>Just keep a single reference to the Hermes instance and pass it around.</strong></p>
				<p>The technical reason is that the shared hermes library is read and FFI bindings are created every time you call <code>new Hermes</code> or <code>withHermes</code>, which is really inefficient.</p>
				<h6 id="back-"><a href="#api">Back ⬆️</a></h6>
				<pre><code class="language-js"><span class="hljs-keyword">new</span> Hermes({
    <span class="hljs-comment">// The broker address (default localhost:1883)</span>
    address: <span class="hljs-string">'localhost:1883'</span>,
    <span class="hljs-comment">// Enables or disables stdout logs (default true).</span>
    <span class="hljs-comment">// Use it in conjunction with the RUST_LOG environment variable. (env RUST_LOG=debug ...)</span>
    logs: <span class="hljs-literal">true</span>,
    <span class="hljs-comment">// Path to the hermes FFI dynamic library file.</span>
    <span class="hljs-comment">// Defaults to the hermes-javascript package folder, usually equivalent to:</span>
    libraryPath: <span class="hljs-string">'node_modules/hermes-javascript/libhermes_mqtt_ffi'</span>,
    <span class="hljs-comment">// Username used when connecting to the broker.</span>
    username: <span class="hljs-string">'user name'</span>,
    <span class="hljs-comment">// Password used when connecting to the broker</span>
    password: <span class="hljs-string">'password'</span>,
    <span class="hljs-comment">// Hostname to use for the TLS configuration. If set, enables TLS.</span>
    tls_hostname: <span class="hljs-string">'hostname'</span>,
    <span class="hljs-comment">// CA files to use if TLS is enabled.</span>
    tls_ca_file: [ <span class="hljs-string">'my-cert.cert'</span> ],
    <span class="hljs-comment">// CA paths to use if TLS is enabled.</span>
    tls_ca_path: [ <span class="hljs-string">'/ca/path'</span>, <span class="hljs-string">'/ca/other/path'</span> ],
    <span class="hljs-comment">// Client key to use if TLS is enabled.</span>
    tls_client_key: <span class="hljs-string">'my-key.key'</span>,
    <span class="hljs-comment">// Client cert to use if TLS is enabled.</span>
    tls_client_cert: <span class="hljs-string">'client-cert.cert'</span>,
    <span class="hljs-comment">// Boolean indicating if the root store should be disabled if TLS is enabled.</span>
    tls_disable_root_store: <span class="hljs-literal">false</span>
})</code></pre>
				<h4 id="dialog-">dialog()</h4>
				<p>Use the Dialog Api Subset.</p>
				<pre><code class="language-js"><span class="hljs-keyword">const</span> dialog = hermes.dialog()</code></pre>
				<h4 id="injection-">injection()</h4>
				<p>Use the Injection Api Subset.</p>
				<pre><code class="language-js"><span class="hljs-keyword">const</span> injection = hermes.injection()</code></pre>
				<h4 id="feedback-">feedback()</h4>
				<p>Use the Sound Feedback Api Subset.</p>
				<pre><code class="language-js"><span class="hljs-keyword">const</span> feedback = hermes.feedback()</code></pre>
				<h4 id="tts-">tts()</h4>
				<p>Use the text-to-speech Api Subset.</p>
				<pre><code class="language-js"><span class="hljs-keyword">const</span> tts = hermes.tts()</code></pre>
				<h4 id="destroy-">destroy()</h4>
				<p>Release all the resources associated with this Hermes instance.</p>
				<pre><code class="language-js">hermes.destroy()</code></pre>
				<h3 id="common-apisubset-methods">Common ApiSubset methods</h3>
				<h6 id="back-"><a href="#api">Back ⬆️</a></h6>
				<p><strong>Check out <a href="https://docs.snips.ai/ressources/hermes-protocol">the hermes protocol documentation</a> for more details on the event names.</strong></p>
				<h4 id="on-eventname-listener-">on(eventName, listener)</h4>
				<p>Subscribes to an event on the bus.</p>
				<pre><code class="language-js"><span class="hljs-keyword">const</span> dialog = hermes.dialog()

dialog.on(<span class="hljs-string">'session_started'</span>, message =&gt; {
    <span class="hljs-comment">/* ... */</span>
})</code></pre>
				<h4 id="once-eventname-listener-">once(eventName, listener)</h4>
				<p>Subscribes to an event on the bus, then unsubscribes after the first event is received.</p>
				<pre><code class="language-js"><span class="hljs-keyword">const</span> dialog = hermes.dialog()

dialog.once(<span class="hljs-string">'intent/myIntent'</span>, message =&gt; {
    <span class="hljs-comment">/* ... */</span>
})</code></pre>
				<h4 id="off-eventname-listener-">off(eventName, listener)</h4>
				<p>Unsubscribe an already existing event.</p>
				<pre><code class="language-js"><span class="hljs-keyword">const</span> dialog = hermes.dialog()

<span class="hljs-keyword">const</span> handler = <span class="hljs-function"><span class="hljs-params">message</span> =&gt;</span> {
    <span class="hljs-comment">/* ... */</span>
}

<span class="hljs-comment">// Subscribes</span>
dialog.on(<span class="hljs-string">'intent/myIntent'</span>, handler)

<span class="hljs-comment">// Unsubscribes</span>
dialog.off(<span class="hljs-string">'intent/myIntent'</span>, handler)</code></pre>
				<h4 id="publish-eventname-message-">publish(eventName, message)</h4>
				<p>Publish an event programatically.</p>
				<pre><code class="language-js"><span class="hljs-keyword">const</span> { Dialog } = <span class="hljs-built_in">require</span>(<span class="hljs-string">'hermes-javascript'</span>)

<span class="hljs-keyword">const</span> dialog = hermes.dialog()

dialog.publish(<span class="hljs-string">'start_session'</span>, {
    <span class="hljs-attr">customData</span>: <span class="hljs-string">'some data'</span>,
    <span class="hljs-attr">siteId</span>: <span class="hljs-string">'site Id'</span>,
    <span class="hljs-attr">init</span>: {
        <span class="hljs-attr">type</span>:  Dialog.enums.initType.notification,
        <span class="hljs-attr">text</span>: <span class="hljs-string">'hello world'</span>
    }
})</code></pre>
				<h3 id="dialog-api-subset">Dialog Api Subset</h3>
				<h6 id="back-"><a href="#api">Back ⬆️</a></h6>
				<p>The dialog manager.</p>
				<h4 id="events-available-for-publishing">Events available for publishing</h4>
				<ul>
					<li><strong>start_session</strong></li>
				</ul>
				<p>Start a new dialog session.</p>
				<pre><code class="language-js"><span class="hljs-keyword">const</span> { Dialog } = <span class="hljs-built_in">require</span>(<span class="hljs-string">'hermes-javascript'</span>)

<span class="hljs-comment">// Start a 'notification type' session that will say whatever is in the "text" field and terminate.</span>

dialog.publish(<span class="hljs-string">'start_session'</span>, {
    <span class="hljs-attr">customData</span>: <span class="hljs-comment">/* string */</span>,
    <span class="hljs-attr">siteId</span>: <span class="hljs-comment">/* string */</span>,
    <span class="hljs-attr">init</span>: {
        <span class="hljs-comment">// An enumeration, either 'action' or 'notification'</span>
        type: Dialog.enums.initType.notification,
        <span class="hljs-attr">text</span>: <span class="hljs-comment">/* string */</span>
    }
})

<span class="hljs-comment">// Start an 'action type' session that will initiate a dialogue with the user.</span>

dialog.publish(<span class="hljs-string">'start_session'</span>, {
    <span class="hljs-attr">customData</span>: <span class="hljs-comment">/* string */</span>,
    <span class="hljs-attr">siteId</span>: <span class="hljs-comment">/* string */</span>,
    <span class="hljs-attr">init</span>: {
        <span class="hljs-comment">// An enumeration, either 'action' or 'notification'</span>
        type: Dialog.enums.initType.action,
        <span class="hljs-attr">text</span>: <span class="hljs-comment">/* string */</span>,
        <span class="hljs-attr">intentFilter</span>: <span class="hljs-comment">/* string[] */</span>,
        <span class="hljs-attr">canBeEnqueued</span>: <span class="hljs-comment">/* boolean */</span>,
        <span class="hljs-attr">sendIntentNotRecognized</span>: <span class="hljs-comment">/* boolean */</span>
    }
})</code></pre>
				<ul>
					<li><strong>continue_session</strong></li>
				</ul>
				<p>Continue a dialog session.</p>
				<pre><code class="language-js">dialog.publish(<span class="hljs-string">'continue_session'</span>, {
    <span class="hljs-attr">sessionId</span>: <span class="hljs-comment">/* string */</span>,
    <span class="hljs-attr">text</span>: <span class="hljs-comment">/* string */</span>,
    <span class="hljs-attr">intentFilter</span>: <span class="hljs-comment">/* string[] */</span>,
    <span class="hljs-attr">customData</span>: <span class="hljs-comment">/* string */</span>,
    <span class="hljs-attr">sendIntentNotRecognized</span>: <span class="hljs-comment">/* boolean */</span>,
    <span class="hljs-attr">slot</span>: <span class="hljs-comment">/* string */</span>
})</code></pre>
				<ul>
					<li><strong>end_session</strong></li>
				</ul>
				<p>Finish a dialog session.</p>
				<pre><code class="language-js">dialog.publish(<span class="hljs-string">'end_session'</span>, {
    <span class="hljs-attr">sessionId</span>: <span class="hljs-comment">/* string */</span>,
    <span class="hljs-attr">text</span>: <span class="hljs-comment">/* string */</span>
})</code></pre>
				<ul>
					<li><strong>configure</strong></li>
				</ul>
				<p>Configure intents that can trigger a session start.</p>
				<pre><code class="language-js">dialog.publish(<span class="hljs-string">'configure'</span>, {
    <span class="hljs-attr">siteId</span>: <span class="hljs-comment">/* string */</span>,
    <span class="hljs-attr">intents</span>: [{
        <span class="hljs-attr">intentId</span>: <span class="hljs-comment">/* string */</span>,
        <span class="hljs-attr">enable</span>: <span class="hljs-comment">/* boolean */</span>
    }]
})</code></pre>
				<h4 id="events-available-for-subscribing">Events available for subscribing</h4>
				<ul>
					<li><strong>intent/[intentName]</strong></li>
				</ul>
				<p>An intent was recognized.</p>
				<ul>
					<li><strong>session_ended</strong></li>
				</ul>
				<p>A dialog session has ended.</p>
				<ul>
					<li><strong>session_queued</strong></li>
				</ul>
				<p>A dialog session has been put in the queue.</p>
				<ul>
					<li><strong>session_started</strong></li>
				</ul>
				<p>A dialog session has started.</p>
				<ul>
					<li><strong>intent_not_recognized</strong></li>
				</ul>
				<p>No intents were recognized.</p>
				<p><em>Note that the dialog session must have been started or continued with the <code>sendIntentNotRecognized</code> flag in order for this to work.</em></p>
				<h3 id="dialogflow">DialogFlow</h3>
				<h6 id="back-"><a href="#api">Back ⬆️</a></h6>
				<p>The Dialog API Subset exposes a small API that makes managing complex dialog flows a breeze.</p>
				<h4 id="flow-intent-action-">flow(intent, action)</h4>
				<p>Starts a new dialog flow.</p>
				<pre><code class="language-js"><span class="hljs-keyword">const</span> dialog = hermes.dialog()

dialog.flow(<span class="hljs-string">'intentName'</span>, (message, flow) =&gt; {

    <span class="hljs-comment">// Chain flow actions (continue / end)…</span>

    <span class="hljs-comment">// Return the text to speech if needed.</span>
    <span class="hljs-keyword">return</span> <span class="hljs-string">'intentName recognized!'</span>
})

<span class="hljs-comment">// You can also return an object that will be used for</span>
<span class="hljs-comment">// the 'continue_session' or 'end_session' parameters.</span>

dialog.flow(<span class="hljs-string">'intentName'</span>, (message, flow) =&gt; {

    <span class="hljs-comment">// Chain flow actions (continue / end)…</span>

    <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">text</span>: <span class="hljs-string">'intentName recognized!'</span>
    }
})

<span class="hljs-comment">// If you need to perform asynchronous calculations</span>
<span class="hljs-comment">// Just return a promise and the flow actions will</span>
<span class="hljs-comment">// be performed afterwards.</span>

dialog.flow(<span class="hljs-string">'intentName'</span>, <span class="hljs-keyword">async</span> (message, flow) =&gt; {
    <span class="hljs-keyword">const</span> json = <span class="hljs-keyword">await</span> fetch(<span class="hljs-string">'something'</span>).then(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> res.json())

    <span class="hljs-comment">// Chain flow actions (continue / end)…</span>

    <span class="hljs-keyword">return</span> <span class="hljs-string">'Fetched some stuff!'</span>
})</code></pre>
				<h4 id="flows-intent-action-">flows([{ intent, action }])</h4>
				<p>Same as <code>flow()</code>, but with multiple starting intents.</p>
				<p>Useful when designing speech patterns with loops <code>((intentOne or intentTwo) -&gt; intentTwo -&gt; intentOne -&gt; intentTwo -&gt; ...</code>,
				so that the starting intents callbacks will <strong>not</strong> get called multiple times if a session is already in progress.</p>
				<pre><code class="language-js"><span class="hljs-keyword">const</span> intents = [
    {
        <span class="hljs-attr">intent</span>: <span class="hljs-string">'intentOne'</span>,
        <span class="hljs-attr">action</span>: <span class="hljs-function">(<span class="hljs-params">msg, flow</span>) =&gt;</span> { <span class="hljs-comment">/* ... */</span> }
    },
    {
        <span class="hljs-attr">intent</span>: <span class="hljs-string">'intentTwo'</span>,
        <span class="hljs-attr">action</span>: <span class="hljs-function">(<span class="hljs-params">msg, flow</span>) =&gt;</span> { <span class="hljs-comment">/* ... */</span> }
    }
]
dialog.flows(intents)</code></pre>
				<h4 id="sessionflow-id-action-">sessionFlow(id, action)</h4>
				<p><strong>Advanced, for basic purposes use flow() or flows().</strong></p>
				<p>Creates a dialog flow that will trigger when the target session starts.
				Useful when initiating a session programmatically.</p>
				<pre><code class="language-js"><span class="hljs-comment">// The id should match the customData value specified on the start_session message.</span>
dialog.sessionFlow(<span class="hljs-string">'a_unique_id'</span>, (msg, flow) =&gt; {
    <span class="hljs-comment">// ... //</span>
})</code></pre>
				<h4 id="flow-continue-intentname-action-slotfiller-">flow.continue(intentName, action, { slotFiller })</h4>
				<p>Subscribes to an intent for the next dialog step.</p>
				<pre><code class="language-js">dialog.flow(<span class="hljs-string">'intentName'</span>, <span class="hljs-keyword">async</span> (message, flow) =&gt; {

    flow.continue(<span class="hljs-string">'otherIntent'</span>, (message, flow) =&gt; {
        <span class="hljs-comment">/* ... */</span>
    })

    flow.continue(<span class="hljs-string">'andAnotherIntent'</span>, (message, flow) =&gt; {
        <span class="hljs-comment">/* ... */</span>
    })

    <span class="hljs-keyword">return</span> <span class="hljs-string">'Continue with either one of these 2 intents.'</span>
})</code></pre>
				<h4 id="about-the-slotfiller-option">About the <code>slotFiller</code> option</h4>
				<p>Set the slot filler for the current dialogue round with a given slot name.</p>
				<p><strong>Requires flow.continue() to be called exactly once in the current round.</strong></p>
				<p>If set, the dialogue engine will not run the the intent classification on the user response and go straight to
				slot filling, assuming the intent is the one passed in the <code>continue</code>, and searching the value of the given slot.</p>
				<pre><code class="language-js"><span class="hljs-comment">// The slot filler is called with value 'slotName' for intent 'myIntent'.</span>
flow.continue(<span class="hljs-string">'myIntent'</span>, (message, flow) =&gt; {
    <span class="hljs-comment">// "message" will be an intent message ("myIntent") with confidence 1.</span>
    <span class="hljs-comment">// The "message.slots" field will either contain an array of "slotName" slots or an empty array,</span>
    <span class="hljs-comment">// depending on whether the platform recognized the slot.</span>
}, { <span class="hljs-attr">slotFiller</span>: <span class="hljs-string">'slotName'</span> })</code></pre>
				<h4 id="flow-notrecognized-action-">flow.notRecognized(action)</h4>
				<p>Add a callback that is going to be executed if the intents failed to be recognized.</p>
				<pre><code class="language-js">dialog.flow(<span class="hljs-string">'intentName'</span>, <span class="hljs-keyword">async</span> (message, flow) =&gt; {

    <span class="hljs-comment">/* Add continuations here ... */</span>

    flow.notRecognized(<span class="hljs-function">(<span class="hljs-params">message, flow</span>) =&gt;</span> {
        <span class="hljs-comment">/* ... */</span>
    })

    <span class="hljs-keyword">return</span> <span class="hljs-string">'If the dialog failed to understand the intents, notRecognized callback will be called.'</span>
})</code></pre>
				<h4 id="flow-end-">flow.end()</h4>
				<p>Ends the dialog flow.</p>
				<pre><code class="language-js">dialog.flow(<span class="hljs-string">'intentName'</span>, <span class="hljs-keyword">async</span> (message, flow) =&gt; {
    flow.end()
    <span class="hljs-keyword">return</span> <span class="hljs-string">'Dialog ended.'</span>
})</code></pre>
				<h3 id="injection-api-subset">Injection Api Subset</h3>
				<h6 id="back-"><a href="#api">Back ⬆️</a></h6>
				<p>Vocabulary injection for the speech recognition.</p>
				<h4 id="events-available-for-publishing">Events available for publishing</h4>
				<ul>
					<li><strong>injection_request</strong></li>
				</ul>
				<p>Requests custom payload to be injected.</p>
				<pre><code class="language-js"><span class="hljs-keyword">const</span> { Injection } = <span class="hljs-built_in">require</span>(<span class="hljs-string">'hermes-javascript'</span>)

injection.publish(<span class="hljs-string">'injection_request'</span>, {
    <span class="hljs-attr">id</span>: <span class="hljs-comment">/* string */</span>,
    <span class="hljs-attr">crossLanguage</span>: <span class="hljs-comment">/* string */</span>,
    <span class="hljs-comment">// An object having string keys mapped with an array of string entries</span>
    lexicon: {
        <span class="hljs-attr">films</span> : [
            <span class="hljs-string">'The Wolf of Wall Street'</span>,
            <span class="hljs-string">'The Lord of the Rings'</span>
        ]
    },
    <span class="hljs-comment">// An array of operations objects</span>
    operations: [
        <span class="hljs-comment">// Each operation is a tuple (an array containing two elements)</span>
        [
            <span class="hljs-comment">// Enumeration: add or addFromVanilla</span>
            <span class="hljs-comment">// see documentation here: https://docs.snips.ai/guides/advanced-configuration/dynamic-vocabulary#3-inject-entity-values</span>
            Injection.enums.injectionKind.add,
            <span class="hljs-comment">// An object, with entities as the key mapped with an array of string entries to inject.</span>
            {
                <span class="hljs-attr">films</span> : [
                    <span class="hljs-string">'The Wolf of Wall Street'</span>,
                    <span class="hljs-string">'The Lord of the Rings'</span>
                ]
            }
        ]
    ]
})</code></pre>
				<ul>
					<li><strong>injection_status_request</strong></li>
				</ul>
				<p>Will request that a new status message will be sent.
				Note that you should subscribe to <code>injection_status</code> beforehand in order to receive the message.</p>
				<pre><code class="language-js">injection.publish(<span class="hljs-string">'injection_status_request'</span>)</code></pre>
				<h4 id="events-available-for-subscribing">Events available for subscribing</h4>
				<ul>
					<li><strong>injection_status</strong></li>
				</ul>
				<p>Get the status of the last injection request.</p>
				<h3 id="feedback-api-subset">Feedback Api Subset</h3>
				<h6 id="back-"><a href="#api">Back ⬆️</a></h6>
				<p>Control the sound feedback.</p>
				<h4 id="events-available-for-publishing">Events available for publishing</h4>
				<ul>
					<li><strong>notification_on</strong></li>
				</ul>
				<p>Turn the notification sound on.</p>
				<pre><code class="language-js">feedback.publish(<span class="hljs-string">'notification_on'</span>, {
    <span class="hljs-string">"siteId"</span>: <span class="hljs-comment">/* string */</span>,
    <span class="hljs-string">"sessionId"</span>: <span class="hljs-comment">/* string */</span>
})</code></pre>
				<ul>
					<li><strong>notification_off</strong></li>
				</ul>
				<p>Turn the notification sound off.</p>
				<pre><code class="language-js">feedback.publish(<span class="hljs-string">'notification_off'</span>, {
    <span class="hljs-string">"siteId"</span>: <span class="hljs-comment">/* string */</span>,
    <span class="hljs-string">"sessionId"</span>: <span class="hljs-comment">/* string */</span>
})</code></pre>
				<h3 id="tts-api-subset">TTS Api Subset</h3>
				<h6 id="back-"><a href="#api">Back ⬆️</a></h6>
				<p>Exposes text-to-speech options.</p>
				<h4 id="events-available-for-publishing">Events available for publishing</h4>
				<ul>
					<li><strong>register_sound</strong></li>
				</ul>
				<p>Register a sound file and makes the TTS able to play it in addition to pure speech.</p>
				<p>You can interpolate a text-to-speech string with the following tag: <code>[[sound:soundId]]</code></p>
				<pre><code class="language-js"><span class="hljs-keyword">const</span> wavBuffer = <span class="hljs-comment">// A Buffer object containing a wav file.</span>

tts.publish(<span class="hljs-string">'register_sound'</span>, {
    <span class="hljs-attr">soundId</span>: <span class="hljs-comment">/* the ID that is going to be used when telling the TTS to play the file */</span>,
    <span class="hljs-attr">wavSound</span>: wavBuffer.toString(<span class="hljs-string">'base64'</span>),
    <span class="hljs-attr">wavSoundLen</span>: wavBuffer.length
})</code></pre>
				<h2 id="license">License</h2>
				<h4 id="apache-2-0-mit">Apache 2.0/MIT</h4>
				<p>Licensed under either of</p>
				<ul>
					<li>Apache License, Version 2.0 (<a href="LICENSE-APACHE">LICENSE-APACHE</a> or
					<a href="http://www.apache.org/licenses/LICENSE-2.0">http://www.apache.org/licenses/LICENSE-2.0</a>)</li>
					<li><p>MIT license (<a href="LICENSE-MIT">LICENSE-MIT</a> or
						<a href="http://opensource.org/licenses/MIT">http://opensource.org/licenses/MIT</a>)</p>
						<p>  at your option.</p>
					</li>
				</ul>
				<h4 id="contribution">Contribution</h4>
				<p>Unless you explicitly state otherwise, any contribution intentionally submitted
					for inclusion in the work by you, as defined in the Apache-2.0 license, shall
				be dual licensed as above, without any additional terms or conditions.</p>
			</div>
		</div>
		<div class="col-4 col-menu menu-sticky-wrap menu-highlight">
			<nav class="tsd-navigation primary">
				<ul>
					<li class="globals  ">
						<a href="globals.html"><em>Globals</em></a>
					</li>
					<li class=" tsd-kind-external-module">
						<a href="modules/api.html">api</a>
					</li>
					<li class=" tsd-kind-external-module">
						<a href="modules/enums.html">enums</a>
					</li>
					<li class=" tsd-kind-external-module">
						<a href="modules/messages.html">messages</a>
					</li>
					<li class=" tsd-kind-external-module">
						<a href="modules/tools.html">tools</a>
					</li>
				</ul>
			</nav>
			<nav class="tsd-navigation secondary menu-sticky">
				<ul class="before-current">
				</ul>
			</nav>
		</div>
	</div>
</div>
<footer class="with-border-bottom">
	<div class="container">
		<h2>Legend</h2>
		<div class="tsd-legend-group">
			<ul class="tsd-legend">
				<li class="tsd-kind-module"><span class="tsd-kind-icon">Module</span></li>
				<li class="tsd-kind-object-literal"><span class="tsd-kind-icon">Object literal</span></li>
				<li class="tsd-kind-variable"><span class="tsd-kind-icon">Variable</span></li>
				<li class="tsd-kind-function"><span class="tsd-kind-icon">Function</span></li>
				<li class="tsd-kind-function tsd-has-type-parameter"><span class="tsd-kind-icon">Function with type parameter</span></li>
				<li class="tsd-kind-index-signature"><span class="tsd-kind-icon">Index signature</span></li>
				<li class="tsd-kind-type-alias"><span class="tsd-kind-icon">Type alias</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-enum"><span class="tsd-kind-icon">Enumeration</span></li>
				<li class="tsd-kind-enum-member"><span class="tsd-kind-icon">Enumeration member</span></li>
				<li class="tsd-kind-property tsd-parent-kind-enum"><span class="tsd-kind-icon">Property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-enum"><span class="tsd-kind-icon">Method</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-interface"><span class="tsd-kind-icon">Interface</span></li>
				<li class="tsd-kind-interface tsd-has-type-parameter"><span class="tsd-kind-icon">Interface with type parameter</span></li>
				<li class="tsd-kind-constructor tsd-parent-kind-interface"><span class="tsd-kind-icon">Constructor</span></li>
				<li class="tsd-kind-property tsd-parent-kind-interface"><span class="tsd-kind-icon">Property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-interface"><span class="tsd-kind-icon">Method</span></li>
				<li class="tsd-kind-index-signature tsd-parent-kind-interface"><span class="tsd-kind-icon">Index signature</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-class"><span class="tsd-kind-icon">Class</span></li>
				<li class="tsd-kind-class tsd-has-type-parameter"><span class="tsd-kind-icon">Class with type parameter</span></li>
				<li class="tsd-kind-constructor tsd-parent-kind-class"><span class="tsd-kind-icon">Constructor</span></li>
				<li class="tsd-kind-property tsd-parent-kind-class"><span class="tsd-kind-icon">Property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-class"><span class="tsd-kind-icon">Method</span></li>
				<li class="tsd-kind-accessor tsd-parent-kind-class"><span class="tsd-kind-icon">Accessor</span></li>
				<li class="tsd-kind-index-signature tsd-parent-kind-class"><span class="tsd-kind-icon">Index signature</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-constructor tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited constructor</span></li>
				<li class="tsd-kind-property tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited method</span></li>
				<li class="tsd-kind-accessor tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited accessor</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-property tsd-parent-kind-class tsd-is-protected"><span class="tsd-kind-icon">Protected property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-class tsd-is-protected"><span class="tsd-kind-icon">Protected method</span></li>
				<li class="tsd-kind-accessor tsd-parent-kind-class tsd-is-protected"><span class="tsd-kind-icon">Protected accessor</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-property tsd-parent-kind-class tsd-is-private"><span class="tsd-kind-icon">Private property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-class tsd-is-private"><span class="tsd-kind-icon">Private method</span></li>
				<li class="tsd-kind-accessor tsd-parent-kind-class tsd-is-private"><span class="tsd-kind-icon">Private accessor</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-property tsd-parent-kind-class tsd-is-static"><span class="tsd-kind-icon">Static property</span></li>
				<li class="tsd-kind-call-signature tsd-parent-kind-class tsd-is-static"><span class="tsd-kind-icon">Static method</span></li>
			</ul>
		</div>
	</div>
</footer>
<div class="container tsd-generator">
	<p>Generated using <a href="http://typedoc.org/" target="_blank">TypeDoc</a></p>
</div>
<div class="overlay"></div>
<script src="assets/js/main.js"></script>
<script>if (location.protocol == 'file:') document.write('<script src="assets/js/search.js"><' + '/script>');</script>
</body>
</html>